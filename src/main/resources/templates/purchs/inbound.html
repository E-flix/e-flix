<!-- ============================================
  - 작성자   : 이혁진
  - 최초작성 : 2025-06-23
  - 설명     : 입고 화면 (AG Grid 적용)
  -----------------------------------------------
  [ 변경 이력 ]
  - 2025-06-23 (이혁진): AG Grid, 레이아웃 통일 적용
============================================ -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{common/layouts/default}">

<div layout:fragment="content" class="container-fluid">
	<div class="col-md-12">
		<div class="radio-group">
			<input type="radio" class="btn-check" name="accountFilter" id="ibd" autocomplete="off" checked>
			<label class="btn btn-outline-secondary btn-sm me-1" for="ibd">입고</label>

			<input type="radio" class="btn-check" name="accountFilter" id="obd" autocomplete="off">
			<label class="btn btn-outline-secondary btn-sm me-1" for="obd">출고</label>

			
		</div>
	</div>

	<div class="card border-0 mt-3">
		<div class="card-body">
			<!-- <h5 class="text-center mb-4">입고 요청</h5> -->
			<div class="row mb-3 align-items-end">
				<div class="col-md-2">
					<label class="form-label">입고날짜</label>
					<input type="date" class="form-control form-control-sm" id="date" readonly>
				</div>
				<div class="col-md-2">
					<label class="form-label">제품명</label>
					<input type="text" class="form-control form-control-sm" id="prodName" placeholder="제품명">
				</div>
				<div class="col-md-2">
					<label class="form-label">제품분류</label>
					<select class="form-control form-control-sm" id="prod">
						<option selected>제품분류선택</option>
						<option value="1">완제품</option>
						<option value="2">반제품</option>
					</select>
				</div>
				<div class="col-md-2">
					<label class="form-label">제품수량</label>
					<input type="text" class="form-control form-control-sm" id="prodAmount" placeholder="제품수량">
				</div>
				<div class="col-md-2">
					<label class="form-label">안전재고량</label>
					<input type="text" class="form-control form-control-sm" id="safeyStockAmount" placeholder="안전재고량">
				</div>
				<div class="col-md-2 d-flex justify-content-end">
					<button type="button" class="btn btn-success btn-sm me-2" id="saveBtn">저장</button>
					<button type="button" class="btn btn-danger btn-sm" id="deleteBtn">삭제</button>
					<button type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#inquiryModal">입고요청</button>
				</div>
			</div>

			<!-- 제품 테이블 (AG Grid) -->
			<div class="grid-container mb-4" style="height: 40vh; width: 100%;">
				<div id="productGrid" class="ag-theme-alpine" style="width: 100%; height: 100%;"></div>
			</div>

			<!-- 창고 테이블 (AG Grid) -->
			<div class="grid-container" style="height: 30vh; width: 100%;">
				<div id="warehouseGrid" class="ag-theme-alpine" style="width: 100%; height: 100%;"></div>
			</div>
		</div>
	</div>
</div>
</html>

<!-- AG Grid 및 페이지 스크립트 -->
<script th:inline="javascript">
	// 기본 데이터
	const productList = [
		{ no: 1, date: "2025-06-18", name: "비누", amount: 500, type: "완제품", safety: 300 },
		{ no: 2, date: "2025-06-18", name: "비누", amount: 500, type: "완제품", safety: 300 },
		{ no: 3, date: "2025-06-18", name: "비누", amount: 500, type: "완제품", safety: 300 }
	];

	const warehouseList = [
		{ no: 1, id: "WH001", location: "대구", volume: 400 }
	];

	// AG Grid: 제품
	const productGridOptions = {
		rowData: productList,
		columnDefs: [
			{ headerName: "no", field: "no" },
			{ headerName: "제품생성일자", field: "date" },
			{ headerName: "제품명", field: "name" },
			{ headerName: "제품수량", field: "amount" },
			{ headerName: "제품분류", field: "type" },
			{ headerName: "안전재고량", field: "safety" }
		],
		rowHeight: 35,
		headerHeight: 35,
		defaultColDef: { resizable: true }
	};

	// AG Grid: 창고
	const warehouseGridOptions = {
		rowData: warehouseList,
		columnDefs: [
			{ headerName: "no", field: "no" },
			{ headerName: "창고번호", field: "id" },
			{ headerName: "창고위치", field: "location" },
			{ headerName: "제품부피", field: "volume" }
		],
		rowHeight: 35,
		headerHeight: 35,
		defaultColDef: { resizable: true }
	};

	// 그리드 초기화
	document.addEventListener("DOMContentLoaded", () => {
		agGrid.createGrid(document.querySelector("#productGrid"), productGridOptions);
		agGrid.createGrid(document.querySelector("#warehouseGrid"), warehouseGridOptions);

		// 창 크기 변화 대응
		window.addEventListener("resize", () => {
			productGridOptions.api?.sizeColumnsToFit();
			warehouseGridOptions.api?.sizeColumnsToFit();
		});
	});
</script>

<script>
	// 오늘 날짜 자동 세팅
	const today = new Date();
	const year = today.getFullYear();
	const month = String(today.getMonth() + 1).padStart(2, '0');
	const day = String(today.getDate()).padStart(2, '0');
	const formattedDate = `${year}-${month}-${day}`;
	document.getElementById('date').value = formattedDate;

	// 입고 → 출고 전환
	document.getElementById('obd').addEventListener('change', function () {
		if (this.checked) {
			window.location.href = '/purchs/obd';
		}
	});
</script>
