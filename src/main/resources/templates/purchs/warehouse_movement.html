<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{common/layouts/default}">
<!-- ============================================
  - 작성자   : 이혁진
  - 최초작성 : 2025-00-00
  - 설명     : 창고간 제품 이동 관리 (AG Grid 적용)
  -----------------------------------------------
  [ 변경 이력 ]
  - 2025-00-00 (이혁진): 페이지 완성
============================================ -->

<head>
	<title>창고이동관리</title>
</head>
<div layout:fragment="content" class="container-fluid">
	<div class="d-flex justify-content-between align-items-center mb-4">
		<h2>창고이동관리</h2>
	</div>
	<!-- 상단 탭 -->
	<div class="col-md-12">
		<div class="radio-group">
			<input type="radio" class="btn-check" name="accountFilter" id="warehouse" autocomplete="off">
			<label class="btn btn-outline-secondary btn-sm me-1" for="warehouse">창고관리</label>

			<input type="radio" class="btn-check" name="accountFilter" id="warehouse_mnt" autocomplete="off" checked>
			<label class="btn btn-outline-secondary btn-sm me-1" for="warehouse_mnt">창고이동</label>
		</div>
	</div>

	<!-- 버튼 -->
	<div class="d-flex justify-content-end mb-2">
		<button type="button" class="btn btn-secondary btn-sm me-2" onclick="resetTransfer()">초기화</button>
		<button type="button" class="btn btn-success btn-sm" onclick="saveTransfer()">저장</button>
	</div>

	<!-- 테이블 -->
	<div class="table-responsive">
		<table class="table table-bordered table-sm text-center align-middle">
			<!-- 창고 테이블 (AG Grid) -->
			<div class="grid-container" style="height: 30vh; width: 100%;">
				<div id="whMovementGrid" class="ag-theme-alpine" style="width: 100%; height: 100%;"></div>
			</div>
		</table>
	</div>
</div>

</html>
<!--Grid Script-->
<script th:inline="javascript">
	let whMovementList = /*[[${}]]*/[];
	// AG Grid: 창고
	const whmGridOptions = {
		rowData: whMovementList,
		rowHeight: 35,
		headerHeight: 35,
		defaultColDef: { resizable: true },
		columnDefs: [
			{ headerName: "제품코드", field: "prodId", editable: false },
			{ headerName: "제품명", field: "prodName", editable: false },
			{ headerName: "창고코드", field: "warehouseId", editable: false },
			{ headerName: "이동전 재고량", field: "이동전", editable: false },
			{ headerName: "이동후 재고량", field: "이동후", editable: false },
			{ headerName: "이동수량", field: "이동수량", editable: false },
			{ headerName: "창고코드", field: "warehouseId", editable: false },
			{ headerName: "이동전 재고량", field: "이동전", editable: false },
			{ headerName: "이동후 재고량", field: "이동후", editable: false },
		],
		rowSelection: {
			mode: "multiRow"
		},
		onGridReady: (params) => {
			whmGridOptions.api = params.api;
			params.api.sizeColumnsToFit();
		}
	};
	// 창 크기 바뀔 때도 다시 꽉 채우기
	window.addEventListener('resize', () => {
		if (whmGridOptions.api) {
			whmGridOptions.api.sizeColumnsToFit();
		}
	});
	// 그리드 초기화
	document.addEventListener("DOMContentLoaded", () => {
		agGrid.createGrid(document.querySelector("#whMovementGrid"), whmGridOptions);
		// 창 크기 변화 대응
		window.addEventListener("resize", () => {
			whmGridOptions.api?.sizeColumnsToFit();
		});
	});
</script>

<!--기능 Script-->
<script>
	function toggleAll(checkbox) {
		const checkboxes = document.querySelectorAll('tbody input[type="checkbox"]');
		checkboxes.forEach(cb => cb.checked = checkbox.checked);
	}

	function resetTransfer() {
		alert("초기화 기능은 개발 중입니다.");
	}

	function saveTransfer() {
		alert("저장 기능은 개발 중입니다.");
	}

	document.getElementById('warehouse').addEventListener('change', function () {
		if (this.checked) {
			window.location.href = '/purchs/wh';
		}
	})
</script>