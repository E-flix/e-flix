<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{common/layouts/default}">
<!-- ============================================
  - ì‘ì„±ì   : ê¹€ì–´ì§„
  - ìµœì´ˆì‘ì„± : 2025-06-18
  - ì„¤ëª…     : ê·¼íƒœ ê´€ë¦¬í™”ë©´ (ê´€ë¦¬ì)
  -----------------------------------------------
  [ ë³€ê²½ ì´ë ¥ ]
  - 2025-06-18 (ê¹€ì–´ì§„): title ë° ë‚´ìš© ì¶”ê°€
  - 2025-06-19 (ê¹€ì–´ì§„): layout êµ¬ì„±
============================================ -->

<head>
    <title>ê·¼íƒœê´€ë¦¬</title>
</head>
<div layout:fragment="content">
    <div id="attdManager">
        
    <!-- í•„í„° ì˜ì—­ -->
    <form class="row g-3 align-items-end mb-4 p-4 border bg-light rounded">
        <div class="col-md-2">
            <label class="form-label">ì‚¬ì›ëª…</label>
            <input type="text" class="form-control" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥ í›„ [enter]" name="empName">
        </div>
        <div class="col-md-2">
            <label class="form-label">ê·¼ë¬´ìƒíƒœ</label>
            <select class="form-select">
                <option value="">ì„ íƒ</option>
                <!-- ì˜µì…˜ ì¶”ê°€ -->
            </select>
        </div>
        <div class="col-md-2">
            <label class="form-label">ë¶€ì„œëª…</label>
            <select class="form-select">
                <option value="">ì„ íƒ</option>
            </select>
        </div>
        <div class="col-md-2">
            <label class="form-label">ë…„ì›”</label>
            <select class="form-select">
                <option>2024ë…„ 11ì›”</option>
            </select>
        </div>
        <div class="col-md-2">
            <label class="form-label">ì§ì±…</label>
            <select class="form-select">
                <option>ì„ íƒ</option>
            </select>
        </div>
        <div class="col-md-2 d-grid gap-2">
            <button type="submit" class="btn btn-primary">ì¡°íšŒ</button>
            <button type="reset" class="btn btn-outline-secondary">ì´ˆê¸°í™”</button>
        </div>
    </form>

    <!-- ìƒë‹¨ ê·¼íƒœ ë¦¬ìŠ¤íŠ¸ -->
    <div class="table-responsive mb-5">
        <table class="table table-bordered table-hover align-middle text-center">
            <thead class="table-light">
                <tr>
                    <th>ì‚¬ë²ˆ</th>
                    <th>ì‚¬ì›ëª…</th>
                    <th>ë¶€ì„œ</th>
                    <th>ì§ì±…</th>
                    <th>ì´ê·¼ë¬´ì¼ìˆ˜</th>
                    <th>ì •ìƒê·¼ë¬´</th>
                    <th>ì´ˆê³¼ê·¼ë¬´</th>
                    <th>ì§€ê°</th>
                    <th>ì¡°í‡´</th>
                    <th>ê²°ê·¼</th>
                    <th>íœ´ê°€</th>
                    <th>ìˆ˜ì •ì¼ì</th>
                </tr>
            </thead>
            <tbody>
                <tr data-bs-toggle="collapse" data-bs-target="#detailRow1" aria-expanded="false" style="cursor:pointer;">
                    <td>1</td>
                    <td>í™ê¸¸ë™</td>
                    <td>ì¸ì‚¬ë¶€</td>
                    <td>ê³¼ì¥</td>
                    <td>20ì¼</td>
                    <td>19ì¼</td>
                    <td>2ì‹œê°„</td>
                    <td>1íšŒ</td>
                    <td>0íšŒ</td>
                    <td>0íšŒ</td>
                    <td>1ì¼</td>
                    <td>2025-06-15</td>
                </tr>
                <tr class="collapse bg-light" id="detailRow1">
                    <td colspan="12">
                        <!-- ìƒì„¸ ì˜ì—­ (ì•„ë˜ì—ì„œ ë³„ë„ ì‘ì„±) -->
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h6 class="card-title fw-bold mb-3">ğŸ“‹ ì‚¬ì› ì •ë³´</h6>
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item"><strong>ì‚¬ì›ëª…:</strong> í™ê¸¸ë™</li>
                                            <li class="list-group-item"><strong>ë…„ì›”:</strong> 2024ë…„ 06ì›”</li>
                                            <li class="list-group-item"><strong>ë¶€ì„œëª…:</strong> A01 ë³¸ì‚¬ â†’ ì¸ì‚¬ë¶€</li>
                                            <li class="list-group-item"><strong>ì •ê·œ ê·¼ë¬´ì¼ìˆ˜:</strong> 20ì¼</li>
                                            <li class="list-group-item"><strong>ì§ì±…:</strong> ê³¼ì¥</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="d-flex justify-content-end mb-2">
                                    <button class="btn btn-success btn-sm me-2" data-bs-toggle="modal" data-bs-target="#editModal">ìˆ˜ì •</button>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-sm table-bordered text-center mb-0">
                                        <thead class="table-light">
                                            <tr>
                                                <th>ë‚ ì§œ</th>
                                                <th>ê·¼ë¬´ìƒíƒœ</th>
                                                <th>ì¶œê·¼ì‹œê°„</th>
                                                <th>í‡´ê·¼ì‹œê°„</th>
                                                <th>ì´ ê·¼ë¬´ì‹œê°„</th>
                                                <th>íŠ¹ì´ì‚¬í•­</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>06-01</td>
                                                <td>ì •ìƒê·¼ë¬´</td>
                                                <td>9:00</td>
                                                <td>18:00</td>
                                                <td>9ì‹œê°„</td>
                                                <td>-</td>
                                            </tr>
                                            <tr>
                                                <td>06-02</td>
                                                <td>ì§€ê°</td>
                                                <td>9:45</td>
                                                <td>18:00</td>
                                                <td>8ì‹œê°„ 15ë¶„</td>
                                                <td>ì§€ê° 1íšŒ</td>
                                            </tr>
                                            <!-- ... -->
                                        </tbody>
                                    </table>
                                </div>
                                <div class="d-flex justify-content-end mt-2">
                                    <button class="btn btn-outline-secondary btn-sm" data-bs-toggle="collapse" data-bs-target="#detailRow1">ë‹«ê¸°</button>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <!-- ë‘ ë²ˆì§¸ ì‚¬ì› -->
                <tr>
                    <td>2</td>
                    <td>í™ìœ¤í¬</td>
                    <td>ì˜ì—…ë¶€</td>
                    <td>ëŒ€ë¦¬</td>
                    <td>20ì¼</td>
                    <td>20ì¼</td>
                    <td>1ì‹œê°„</td>
                    <td>0íšŒ</td>
                    <td>0íšŒ</td>
                    <td>0íšŒ</td>
                    <td>0ì¼</td>
                    <td>-</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal fade" id="editModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ê·¼íƒœ ìƒì„¸ ìˆ˜ì •</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ë‹«ê¸°"></button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table class="table table-bordered table-sm align-middle text-center" id="editTable">
                            <thead class="table-light">
                                <tr>
                                    <th>ë‚ ì§œ</th>
                                    <th>ê·¼ë¬´ìƒíƒœ</th>
                                    <th>ì¶œê·¼ì‹œê°„</th>
                                    <th>í‡´ê·¼ì‹œê°„</th>
                                    <th>ì´ ê·¼ë¬´ì‹œê°„</th>
                                    <th>íŠ¹ì´ì‚¬í•­</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>06-01</td>
                                    <td ondblclick="editCell(this)">ì •ìƒê·¼ë¬´</td>
                                    <td ondblclick="editCell(this)">9:00</td>
                                    <td ondblclick="editCell(this)">18:00</td>
                                    <td ondblclick="editCell(this)">9ì‹œê°„</td>
                                    <td ondblclick="editCell(this)">-</td>
                                </tr>
                                <!-- ... -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary">ì €ì¥</button>
                    <button class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
                </div>
            </div>
        </div>
    </div>
    <script>
        $(function () {
            
        });
    </script>
        <!-- ìŠ¤í¬ë¦½íŠ¸ -->
        <script>
            const coIdx = "co-201"
            function showDetail(name) {
                document.getElementById('detailSection').style.display = 'block';
                // ì¶”ê°€ì ìœ¼ë¡œ ì„ íƒí•œ ì‚¬ì› ë°ì´í„°ë¡œ ê°±ì‹ í•  ìˆ˜ ìˆìŒ
            }

            function hideDetail() {
                document.getElementById('detailSection').style.display = 'none';
            }

            function editCell(cell) {
                const originalText = cell.innerText;
                const input = document.createElement("input");
                input.type = "text";
                input.value = originalText;
                input.classList.add("form-control");
                input.onblur = function () {
                    cell.innerText = input.value || originalText;
                };
                cell.innerText = "";
                cell.appendChild(input);
                input.focus();
            }

            $("#searchBtn").on("click", function () {
                const query = {
                    empName: $("#empName").val(),
                }
                $.ajax({
                    url: "/hr/am/search",
                    type: "GET",
                    data: query,
                    dataType: 'json',
                    success: function (code) {
                        if (code === '200') {
                            alert('ì„±ê³µ')
                        }
                    },
                    error: function (xhr, status, err) {
                        console.error(err);
                    }
                })
            });
            function loadDept() {
                $.ajax({
                    url: "/hr/dept/list/all?coIdx=" + coIdx,
                    type: "GET",
                    success: function (res) {
                        $("#deptSelect").empty();
                        $.each(res, function (i, item) {
                            let option = `<option value="${item.deptIdx}">${item.deptName}</option>`;
                            $("#deptSelect").append(option);
                        });
                    },
                    error: function (xhr, status, err) {
                        console.error(err);
                    }
                })
            }
            $(document).ready(function () {
                loadDept();
            });
        </script>
    </div>
</div>